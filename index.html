<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <title>Klinecharts</title>
    <script src="./dist/klinecharts.development.js"></script>
    <style>
        *{
            padding: 0;
            margin: 0;
        }
        /* #basic-k-line{
            margin: 0 auto;
            width: 600px;
            height: 600px;
            background: #25272F;
        } */
        body{
            width: 7.5rem;
        }
        p{
            width: 7.5rem;
            overflow: hidden;
        }
        #basic-k-line{
            margin: 0 auto;
            width:7.5rem;
            height: 6rem;
            background: #25272F;
        }
        #basic-k-line1{
            margin: 0 auto;
            width:7.5rem;
            height: 6rem;
            background: #25272F;
        }
    </style>
</head>
<body>
    <div>
        <div id="basic-k-line" class="k-line-chart"></div>
        <button id="button">添加</button>
        <button id="shanchu">删除</button>
    </div>
    
    <!-- <div id="basic-k-line1" class="k-line-chart1"></div> -->
    <script type="module">


        // import 'core-js'
        const kLineChart = klinecharts.init('basic-k-line');
        // let logoData={
        //     width:'100',
        //     height: '100',
        //     x:0.5,
        //     y:0.5,
        //     imgUrl: "https://avatar-static.segmentfault.com/176/733/1767336339-5f61a9c227466_big64"
        // }
        // kLineChart.setLogoData(logoData);
        let Kdata=[];
        for(let i=0;i<1000;i++){
            let suiji=Math.floor(Math.random() * 10);
            if(suiji>=5){
                Kdata.push({ close: Math.floor(Math.random() * 100), high: Math.floor(Math.random() * 100), low: Math.floor(Math.random() * 100), open: Math.floor(Math.random() * 100), timestamp: 1587660000000, volume: Math.floor(Math.random() * 100)});
            }else{
                Kdata.push({ close: Math.floor(Math.random() * 100), high: Math.floor(Math.random() * 100), low: Math.floor(Math.random() * 100), open: Math.floor(Math.random() * 100), timestamp: 1587660000000, volume: Math.floor(Math.random() * 100)});
            }
        }
        kLineChart.applyNewData(Kdata)
        kLineChart.createTechnicalIndicator('MACD', 100);
        kLineChart.createTechnicalIndicator('BOLL', 100);
        
        
        
        

        // 水平轴提示
        let axisData={
            // 标记线文字提示
            tooltip:'点击绿',
            // 标记线值
            value:50,
            // x軸位置
            shaftX: 50,
            // 标记线固定
            fixed: true,
            data:{
                PId: "01EDARSEEBSB5K42CPYA359TX234G",
                name: 'number',
                type:'text',
                text: '0.12345',
                color: '#62C794',
                font: '14px bold 黑体',
                background: '#fff',
                width: 70,
                height: 30,
                borderLine: 1,
                borderColor: '#62C794',
                textOffsetTop: 10,
                textOffsetLeft: 3
            },
            // 标记线条样式
            lineStyle:{
                // 标记线颜色
                color: '#62C794',
                dashValue: [3,4],
                size: 1,
                style: "dash"
            },
            // 标记文字样式
            textStyle:{
                color: "#000",
                background: '#62C794',
                family: "Helvetica Neue",
                paddingBottom: 2,
                paddingLeft: 2,
                paddingRight: 2,
                paddingTop: 2,
                size: 12,
                weight: "normal"
            },
            // 出现弹框样式
            boxStyle:{
                width: 240,
                height: 30,
                background: '#fff',
                borderLine: 1,
                borderColor: '#62C794',
                borderRadius: 2,
                item:[
                    {
                        name: 'number',
                        type:'text',
                        text: '0.12345',
                        color: '#62C794',
                        font: '14px bold 黑体',
                        background: '#fff',
                        width: 70,
                        height: 30,
                        borderLine: 1,
                        borderColor: '#62C794',
                        textOffsetTop: 16,
                        textOffsetLeft: 3
                    }, {
                        name: 'sheet',
                        type:'text',
                        text: '100 张',
                        color: '#fff        ',
                        font: '14px bold 黑体',
                        background: '#62C794',
                        width: 80,
                        height: 30,
                        borderLine: 1,
                        borderColor: '#62C794',
                        textOffsetTop: 16,
                        textOffsetLeft: 5
                    }, {
                        name: 'amend',
                        event: 'amend',
                        type:'text',
                        text: '加',
                        color: '#62C794',
                        background: '#fff',
                        width: 30,
                        height: 30,
                        imgWidth: 20,
                        imgHeight: 20,
                        borderLine: 0,
                        borderColor: '#62C794',
                        textOffsetTop: 16,
                        textOffsetLeft: 5,
                        clickable:true
                    }, {
                        name: 'fixed',
                        event: 'fixed',
                        type:'text',
                        text: '減',
                        color: '#62C794',
                        background: '#fff',
                        width: 30,
                        height: 30,
                        imgWidth: 20,
                        imgHeight: 20,
                        borderLine: 0,
                        borderColor: '#62C794',
                        textOffsetTop: 16,
                        textOffsetLeft: 5,
                        clickable:true
                    }, {
                        name:'delete',
                        event: 'delete',
                        type:'text',
                        text: '刪',
                        color: '#62C794',
                        background: '#fff',
                        width: 30,
                        height: 30,
                        imgWidth: 20,
                        imgHeight: 20,
                        borderLine: 0,
                        borderColor: '#62C794',
                        textOffsetTop: 16,
                        textOffsetLeft: 5,
                        clickable:true
                    }
                ]
            },
            // 回调函数
            agentClick(item,data){
                agentTrigger(item,data);
            }
        };
        kLineChart.addLabeledLine(axisData,'PId');

        // // 水平轴提示
        // let axisData2={
        //     // 标记线文字提示
        //     tooltip:'点击蓝',
        //     // 标记线值
        //     value:50,
        //     // x軸位置
        //     shaftX: 50,
        //     // 标记线固定
        //     fixed: true,
        //     data:{
        //         PId: "01EDARSEEBSB5K42CPYA359TXG345",
        //         name: 'number',
        //         type:'text',
        //         text: '0.12345',
        //         color: 'blue',
        //         font: '14px bold 黑体',
        //         background: '#fff',
        //         width: 70,
        //         height: 30,
        //         borderLine: 1,
        //         borderColor: 'blue',
        //         textOffsetTop: 10,
        //         textOffsetLeft: 3
        //     },
        //     // 标记线条样式
        //     lineStyle:{
        //         // 标记线颜色
        //         color: 'blue',
        //         dashValue: [3,4],
        //         size: 1,
        //         style: "dash"
        //     },
        //     // 标记文字样式
        //     textStyle:{
        //         color: "#000",
        //         background: '#fff',
        //         family: "Helvetica Neue",
        //         paddingBottom: 2,
        //         paddingLeft: 2,
        //         paddingRight: 2,
        //         paddingTop: 2,
        //         size: 12,
        //         weight: "normal"
        //     },
        //     // 出现弹框样式
        //     boxStyle:{
        //         width: 240,
        //         height: 30,
        //         background: '#fff',
        //         borderLine: 1,
        //         borderColor: 'blue',
        //         borderRadius: 2,
        //         item:[
        //             {
        //                 name: 'number',
        //                 type:'text',
        //                 text: '0.45687',
        //                 color: 'blue',
        //                 font: '14px bold 黑体',
        //                 background: '#fff',
        //                 width: 70,
        //                 height: 30,
        //                 borderLine: 1,
        //                 borderColor: 'blue',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 3
        //             }, {
        //                 name: 'sheet',
        //                 type:'text',
        //                 text: '103 张',
        //                 color: '#fff        ',
        //                 font: '14px bold 黑体',
        //                 background: 'blue',
        //                 width: 80,
        //                 height: 30,
        //                 borderLine: 1,
        //                 borderColor: 'blue',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5
        //             }, {
        //                 name: 'amend',
        //                 event: 'amend',
        //                 type:'text',
        //                 text: '加',
        //                 color: 'blue',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'blue',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }, {
        //                 name: 'fixed',
        //                 event: 'fixed',
        //                 type:'text',
        //                 text: '減',
        //                 color: 'blue',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'blue',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }, {
        //                 name:'delete',
        //                 event: 'delete',
        //                 type:'text',
        //                 text: '刪',
        //                 color: 'blue',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'blue',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }
        //         ]
        //     },
        //     // 回调函数
        //     agentClick(item,data){
        //         agentTrigger(item,data);
        //     }
        // };
        // kLineChart.addLabeledLine(axisData2,'PId');

        // // 水平轴提示
        // let axisData3={
        //     // 标记线文字提示
        //     tooltip:'点击红',
        //     // 标记线值
        //     value:50,
        //     // x軸位置
        //     shaftX: 80,
        //     // 标记线固定
        //     fixed: true,
        //     data:{
        //         PId: "01EDARSEEBSB5K42CPYA359TXG123",
        //         name: 'number',
        //         type:'text',
        //         text: '0.12345',
        //         color: 'red',
        //         font: '14px bold 黑体',
        //         background: '#fff',
        //         width: 70,
        //         height: 30,
        //         borderLine: 1,
        //         borderColor: 'red',
        //         textOffsetTop: 10,
        //         textOffsetLeft: 3
        //     },
        //     // 标记线条样式
        //     lineStyle:{
        //         // 标记线颜色
        //         color: 'red',
        //         dashValue: [3,4],
        //         size: 1,
        //         style: "dash"
        //     },
        //     // 标记文字样式
        //     textStyle:{
        //         color: "#000",
        //         background: '#fff',
        //         family: "Helvetica Neue",
        //         paddingBottom: 2,
        //         paddingLeft: 2,
        //         paddingRight: 2,
        //         paddingTop: 2,
        //         size: 12,
        //         weight: "normal"
        //     },
        //     // 出现弹框样式
        //     boxStyle:{
        //         width: 240,
        //         height: 30,
        //         background: '#fff',
        //         borderLine: 1,
        //         borderColor: 'red',
        //         borderRadius: 2,
        //         item:[
        //             {
        //                 name: 'number',
        //                 type:'text',
        //                 text: '0.45687',
        //                 color: 'red',
        //                 font: '14px bold 黑体',
        //                 background: '#fff',
        //                 width: 70,
        //                 height: 30,
        //                 borderLine: 1,
        //                 borderColor: 'red',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 3
        //             }, {
        //                 name: 'sheet',
        //                 type:'text',
        //                 text: '103 张',
        //                 color: '#fff        ',
        //                 font: '14px bold 黑体',
        //                 background: 'red',
        //                 width: 80,
        //                 height: 30,
        //                 borderLine: 1,
        //                 borderColor: 'red',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5
        //             }, {
        //                 name: 'amend',
        //                 event: 'amend',
        //                 type:'text',
        //                 text: '加',
        //                 color: 'red',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'red',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }, {
        //                 name: 'fixed',
        //                 event: 'fixed',
        //                 type:'text',
        //                 text: '減',
        //                 color: 'red',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'red',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }, {
        //                 name:'delete',
        //                 event: 'delete',
        //                 type:'text',
        //                 text: '刪',
        //                 color: 'red',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'red',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }
        //         ]
        //     },
        //     // 回调函数
        //     agentClick(item,data){
        //         agentTrigger(item,data);
        //     }
        // };
        // kLineChart.addLabeledLine(axisData3,'PId');

        // // 水平轴提示
        // let axisData4={
        //     // 标记线文字提示
        //     tooltip:'点击黄',
        //     // 标记线值
        //     value:50,
        //     // x軸位置
        //     shaftX: 110,
        //     // 标记线固定
        //     fixed: true,
        //     data:{
        //         PId: "01EDARSEEBSB5K42CPYA359TXG345",
        //         name: 'number',
        //         type:'text',
        //         text: '0.12345',
        //         color: 'yellow',
        //         font: '14px bold 黑体',
        //         background: '#fff',
        //         width: 70,
        //         height: 30,
        //         borderLine: 1,
        //         borderColor: 'yellow',
        //         textOffsetTop: 10,
        //         textOffsetLeft: 3
        //     },
        //     // 标记线条样式
        //     lineStyle:{
        //         // 标记线颜色
        //         color: 'yellow',
        //         dashValue: [3,4],
        //         size: 1,
        //         style: "dash"
        //     },
        //     // 标记文字样式
        //     textStyle:{
        //         color: "#000",
        //         background: '#fff',
        //         family: "Helvetica Neue",
        //         paddingBottom: 2,
        //         paddingLeft: 2,
        //         paddingRight: 2,
        //         paddingTop: 2,
        //         size: 12,
        //         weight: "normal"
        //     },
        //     // 出现弹框样式
        //     boxStyle:{
        //         width: 240,
        //         height: 30,
        //         background: '#fff',
        //         borderLine: 1,
        //         borderColor: 'yellow',
        //         borderRadius: 2,
        //         item:[
        //             {
        //                 name: 'number',
        //                 type:'text',
        //                 text: '0.45687',
        //                 color: 'yellow',
        //                 font: '14px bold 黑体',
        //                 background: '#fff',
        //                 width: 70,
        //                 height: 30,
        //                 borderLine: 1,
        //                 borderColor: 'yellow',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 3
        //             }, {
        //                 name: 'sheet',
        //                 type:'text',
        //                 text: '103 张',
        //                 color: '#fff        ',
        //                 font: '14px bold 黑体',
        //                 background: 'yellow',
        //                 width: 80,
        //                 height: 30,
        //                 borderLine: 1,
        //                 borderColor: 'yellow',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5
        //             }, {
        //                 name: 'amend',
        //                 event: 'amend',
        //                 type:'text',
        //                 text: '加',
        //                 color: 'yellow',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'yellow',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }, {
        //                 name: 'fixed',
        //                 event: 'fixed',
        //                 type:'text',
        //                 text: '減',
        //                 color: 'yellow',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'yellow',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }, {
        //                 name:'delete',
        //                 event: 'delete',
        //                 type:'text',
        //                 text: '刪',
        //                 color: 'yellow',
        //                 background: '#fff',
        //                 width: 30,
        //                 height: 30,
        //                 imgWidth: 20,
        //                 imgHeight: 20,
        //                 borderLine: 0,
        //                 borderColor: 'yellow',
        //                 textOffsetTop: 16,
        //                 textOffsetLeft: 5,
        //                 clickable:true
        //             }
        //         ]
        //     },
        //     // 回调函数
        //     agentClick(item,data){
        //         agentTrigger(item,data);
        //     }
        // };
        // kLineChart.addLabeledLine(axisData4, 'PId');
        kLineChart.refreshTheView();

        function agentTrigger(item,data){
            if(item.event=="amend"){    //修改方法
                let sum=parseInt(data.boxStyle.item[1].text);
                sum++;
                let random= Math.random().toFixed(5);
                let modify=[
                    {
                        name: 'data',
                        data:{
                            PId: "01EDARSEEBSB5K42CPYA359TX234G",
                            name: 'number',
                            type:'text',
                            text: '0.12345',
                            color: '#62C794',
                            font: '14px bold 黑体',
                            background: '#fff',
                            width: 70,
                            height: 30,
                            borderLine: 1,
                            borderColor: '#62C794',
                            textOffsetTop: 10,
                            textOffsetLeft: 3
                        }
                    }, {   // main修改主体
                        name:'main'
                    }, { // 标记线条
                        name: 'lineStyle'
                    }, { // 标记文字
                        name: 'textStyle'
                    }, {  // 弹框样式
                        name: 'boxStyle',
                        item: [
                            {
                                name: 'number',
                                text: random
                            }, {
                                name: 'sheet',
                                text: `${sum} 张`
                            }
                        ]
                    }
                ]
                kLineChart.modifyLabeledLine(data.id,modify);
                kLineChart.refreshTheView();
            }else if(item.event=="delete"){ //删除方法
                kLineChart.deleteLabeledLine(data.id);
                kLineChart.refreshTheView();
            }
        }

        


        let but=document.getElementById('button');
        but.onclick=()=>{
            let random= Math.random().toFixed(5);
            let modify=[
                {
                    name: 'data',
                    data:{
                        PId: "01EDARSEEBSB5K42CPYA359TX234G",
                        name: 'number',
                        type:'text',
                        text: '0.12345',
                        color: '#62C794',
                        font: '14px bold 黑体',
                        background: '#fff',
                        width: 70,
                        height: 30,
                        borderLine: 1,
                        borderColor: '#62C794',
                        textOffsetTop: 10,
                        textOffsetLeft: 3
                    }
                },
                {  // 弹框样式
                    name: 'boxStyle',
                    item: [
                        {
                            name: 'number',
                            text: random
                        }
                    ]
                }
            ]
            kLineChart.modifyLabeledLine(axisData.data.PId,modify);
            kLineChart.refreshTheView();
        }
        let shanchu=document.getElementById('shanchu');
        shanchu.onclick=()=>{
            kLineChart.deleteLabeledLine(axisData.data.PId);
            kLineChart.refreshTheView();
        }

        
 
        
    </script>
    <script>
        var html = document.documentElement;
        html.style.fontSize= 100*(html.clientWidth / 750 )+'px';
        document.body.style.fontSize = '16px';
    </script>
</body>
</html>